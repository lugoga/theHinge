mycolor2 = c("#040ED8", "#2050FF", "#4196FF", "#6DC1FF", "#86D9FF", "#9CEEFF", "#AFF5FF", "#CEFFFF", "#FFFE47", "#FFEB00", "#FFC400", "#FF9000", "#FF4800", "#FF0000", "#D50000", "#9E0000")
mycolor3 = c("#9000B0", "#C900B0", "#C760AF", "#1190F9", "#60C8F8", "#90C9F8", "#F8F8F8", "#F8F800",  "#F8D730", "#f8b030", "#f8602f", "#f80000")
ggplot()+
metR::geom_contour_fill(data = temperature, aes(x = lon, y = lat, z = temperature),bins = 120)+
metR::geom_contour2(data = temperature, aes(x = lon, y = lat, z = temperature,label = ..level..), breaks = 0, color = "red")+
ggspatial::layer_spatial(data = World, fill = NA)+
coord_sf(xlim = c(-180,180), ylim = c(-70,70))+
# metR::scale_fill_divergent(midpoint = 0)+
scale_fill_gradientn(colours = mycolor3,
# trans = scales::modulus_trans(p = .1),
name = expression(T~(degree*C))) +
theme_bw(base_size = 12)+
theme(axis.title = element_blank())+
# metR::scale_y_latitude(ticks = 15)+
metR::scale_x_longitude()
ggplot()+
metR::geom_contour_fill(data = temperature, aes(x = lon, y = lat, z = temperature),bins = 120)+
metR::geom_contour2(data = temperature, aes(x = lon, y = lat, z = temperature,label = ..level..), breaks = 0, color = "red")+
ggspatial::layer_spatial(data = World, fill = NA)+
coord_sf(xlim = c(-180,180), ylim = c(-70,70))+
# metR::scale_fill_divergent(midpoint = 0)+
scale_fill_gradientn(colours = mycolor3,
# trans = scales::modulus_trans(p = .1),
name = expression(T~(degree*C))) +
theme_bw(base_size = 12)+
theme(axis.title = element_blank())+
# metR::scale_y_latitude(ticks = 15)+
metR::scale_x_longitude()
temperature = global %>% filter(year == 2021)
ggplot()+
metR::geom_contour_fill(data = temperature, aes(x = lon, y = lat, z = temperature),bins = 120)+
metR::geom_contour2(data = temperature, aes(x = lon, y = lat, z = temperature,label = ..level..), breaks = 0, color = "red")+
ggspatial::layer_spatial(data = World, fill = NA)+
coord_sf(xlim = c(-180,180), ylim = c(-70,70))+
# metR::scale_fill_divergent(midpoint = 0)+
scale_fill_gradientn(colours = mycolor3,
# trans = scales::modulus_trans(p = .1),
name = expression(T~(degree*C))) +
theme_bw(base_size = 12)+
theme(axis.title = element_blank())+
# metR::scale_y_latitude(ticks = 15)+
metR::scale_x_longitude()
temperature = global %>% filter(year == 2020)
ggplot()+
metR::geom_contour_fill(data = temperature, aes(x = lon, y = lat, z = temperature),bins = 120)+
metR::geom_contour2(data = temperature, aes(x = lon, y = lat, z = temperature,label = ..level..), breaks = 0, color = "red")+
ggspatial::layer_spatial(data = World, fill = NA)+
coord_sf(xlim = c(-180,180), ylim = c(-70,70))+
# metR::scale_fill_divergent(midpoint = 0)+
scale_fill_gradientn(colours = mycolor3,
# trans = scales::modulus_trans(p = .1),
name = expression(T~(degree*C))) +
theme_bw(base_size = 12)+
theme(axis.title = element_blank())+
# metR::scale_y_latitude(ticks = 15)+
metR::scale_x_longitude()
temperature = global %>% filter(year == 2021)
ggplot()+
metR::geom_contour_fill(data = temperature, aes(x = lon, y = lat, z = temperature),bins = 120)+
metR::geom_contour2(data = temperature, aes(x = lon, y = lat, z = temperature,label = ..level..), breaks = 0, color = "red")+
ggspatial::layer_spatial(data = World, fill = NA)+
coord_sf(xlim = c(-180,180), ylim = c(-70,70))+
# metR::scale_fill_divergent(midpoint = 0)+
scale_fill_gradientn(colours = mycolor3,
# trans = scales::modulus_trans(p = .1),
name = expression(T~(degree*C))) +
theme_bw(base_size = 12)+
theme(axis.title = element_blank())+
# metR::scale_y_latitude(ticks = 15)+
metR::scale_x_longitude()
temperature = global %>% filter(year == 2021)
ggplot()+
metR::geom_contour_fill(data = temperature, aes(x = lon, y = lat, z = temperature),bins = 120)+
metR::geom_contour2(data = temperature, aes(x = lon, y = lat, z = temperature,label = ..level..), breaks = 0, color = "red")+
ggspatial::layer_spatial(data = World, fill = NA)+
coord_sf(xlim = c(-180,180), ylim = c(-70,70))+
# metR::scale_fill_divergent(midpoint = 0)+
scale_fill_gradientn(colours = mycolor3,
# trans = scales::modulus_trans(p = .1),
name = expression(T~(degree*C))) +
theme_bw(base_size = 12)+
theme(axis.title = element_blank())+
# metR::scale_y_latitude(ticks = 15)+
metR::scale_x_longitude()
monthly = read_csv("../data/temperature_lss.csv")
monthly
m = monthly %>% prophet()
ts = monthly %$%
ts(start = c(1980,1), frequency = 12)
ts
ts = monthly %>% pull(temperature)
ts
ts %>% autoplot()
ts
monthly %>% pull(temperature)
ts = monthly %>% pull(temperature) %>%
ts(start = c(1980,1), frequency = 12)
ts %>% autoplot()
ts
ts %>% plot()
ts %>% autoplot()
ts %>% plot()
monthly
ts = monthly %>% pull(temperature) %>%
ts(start = c(1980,1), frequency = 12)
ts
monthly %>% tail()
monthly %>% pull(temperature)
ts = monthly %>% pull(temperature) %>% stats::ts(start = c(1980,1), frequency = 12)
ts
monthly
ts = monthly %>% pull(temperature) %>% stats::ts(start = c(1880,1), frequency = 12)
ts %>% plot()
ts %>% autoplot()
ts = monthly %>%
pull(temperature) %>%
ts(start = c(1880,1), frequency = 12)
ts
ts = monthly %>%
pull(temperature) %>%
ts(start = c(1880,1), frequency = 12)
ts
ts %>% autoplot()
ts = monthly %>%
pull(temperature) %>%
ts(start = c(1880,1), frequency = 12) %>%
decompose()
ts$x %>%
autoplot()
ts$x
ts$x %>%
plot()
ts$x %>%  window(start = c(1980,1))
ts$x %>%  window(start = c(1980,1)) %>%
plot()
ts.temp = monthly %>%
pull(temperature) %>%
ts(start = c(1880,1), frequency = 12)
ts.temp %>%
window(start = c(1980,1)) %>%
plot()
ts.temp %>%
window(start = c(1980,1)) %>%
autoplot()
ts.temp %>%
TSstudio::ts_to_prophet()
ts.temp %>%
window(start = c(1980,1)) %>%
TSstudio::ts_to_prophet()
ts.df %>%
ggplot(aes(x = ds, y = y))
ts.df = ts.temp %>%
window(start = c(1980,1)) %>%
TSstudio::ts_to_prophet()
ts.df %>%
ggplot(aes(x = ds, y = y))
ts.df %>%
ggplot(aes(x = ds, y = y))+
geom_line()
ts.df %>%
ggplot(aes(x = ds, y = y))+
geom_line()+
geom_smooth()
ts.df %>%
ggplot(aes(x = ds, y = y))+
geom_line()+
geom_smooth()+
scale_y_continuous(name = expression(Temperature~(degree*C)))
ts.df %>%
ggplot(aes(x = ds, y = y))+
geom_line()+
geom_smooth()+
scale_y_continuous(name = expression(Temperature~(degree*C)))+
scale_x_date(date_breaks = "5 year")
ts.df %>%
ggplot(aes(x = ds, y = y))+
geom_line()+
geom_smooth()+
scale_y_continuous(name = expression(Temperature~(degree*C)))+
scale_x_date(date_breaks = "5 year", labels = scales::label_date_short())
ts.df %>%
ggplot(aes(x = ds, y = y))+
geom_line()+
geom_smooth()+
scale_y_continuous(name = expression(Temperature~(degree*C)))+
scale_x_date(date_breaks = "4 year", labels = scales::label_date_short())
ts.df %>%
ggplot(aes(x = ds, y = y))+
geom_line()+
geom_smooth()+
scale_y_continuous(name = expression(Temperature~(degree*C)))+
scale_x_date(date_breaks = "10 year", labels = scales::label_date_short())
ts.df %>%
ggplot(aes(x = ds, y = y))+
geom_line()+
geom_smooth()+
scale_y_continuous(name = expression(Temperature~(degree*C)))+
scale_x_date(date_breaks = "2 year", labels = scales::label_date_short())
ts.df %>%
ggplot(aes(x = ds, y = y))+
geom_line()+
geom_smooth()+
scale_y_continuous(name = expression(Temperature~(degree*C)))+
scale_x_date(date_breaks = "3 year", labels = scales::label_date_short())
ts.df %>%
ggplot(aes(x = ds, y = y))+
geom_line()+
geom_smooth()+
scale_y_continuous(name = expression(Temperature~(degree*C)))+
scale_x_date(date_breaks = "3 year", labels = scales::label_date_short())+
theme_bw()
ts.df %>%
ggplot(aes(x = ds, y = y))+
geom_line()+
geom_smooth()+
scale_y_continuous(name = expression(Temperature~(degree*C)))+
scale_x_date(date_breaks = "3 year", labels = scales::label_date_short())+
theme_bw()
ts.df %>%
ggplot(aes(x = ds, y = y))+
geom_line()+
geom_smooth()+
scale_y_continuous(name = expression(Temperature~(degree*C)))+
scale_x_date(date_breaks = "3 year", labels = scales::label_date_short())+
theme_bw(base_size = 11)
ts.df %>%
ggplot(aes(x = ds, y = y))+
geom_line()+
geom_smooth()+
scale_y_continuous(name = expression(Temperature~(degree*C)))+
scale_x_date(date_breaks = "3 year", labels = scales::label_date_short())+
theme_bw(base_size = 12)
ts.df %>%
ggplot(aes(x = ds, y = y))+
geom_line()+
geom_smooth()+
scale_y_continuous(name = expression(Temperature~(degree*C)))+
scale_x_date(date_breaks = "3 year", labels = scales::label_date_short())+
theme_bw(base_size = 12)
ts.df %>%
ggplot(aes(x = ds, y = y))+
geom_line()+
geom_smooth()+
scale_y_continuous(name = expression(Temperature~(degree*C)))+
scale_x_date(date_breaks = "3 year", labels = scales::label_date_short())+
theme_bw(base_size = 12)
ts.df %>%
ggplot(aes(x = ds, y = y))+
geom_line()+
geom_smooth()+
scale_y_continuous(name = expression(Temperature~(degree*C)))+
scale_x_date(date_breaks = "3 year", labels = scales::label_date_short())+
theme_bw(base_size = 12)
ts.df %>%
ggplot(aes(x = ds, y = y))+
geom_line()+
geom_smooth(fill = "red")+
scale_y_continuous(name = expression(Temperature~(degree*C)))+
scale_x_date(date_breaks = "3 year", labels = scales::label_date_short())+
theme_bw(base_size = 12)
ts.df %>%
ggplot(aes(x = ds, y = y))+
geom_line()+
geom_smooth(fill = "red", color = "red")+
scale_y_continuous(name = expression(Temperature~(degree*C)))+
scale_x_date(date_breaks = "3 year", labels = scales::label_date_short())+
theme_bw(base_size = 12)
ts.df %>%
ggplot(aes(x = ds, y = y))+
geom_line()+
geom_smooth(fill = "red", color = "red", alpha = .2)+
scale_y_continuous(name = expression(Temperature~(degree*C)))+
scale_x_date(date_breaks = "3 year", labels = scales::label_date_short())+
theme_bw(base_size = 12)
ts.df %>%
ggplot(aes(x = ds, y = y))+
geom_line()+
geom_smooth(fill = "green", color = "red", alpha = .2)+
scale_y_continuous(name = expression(Temperature~(degree*C)))+
scale_x_date(date_breaks = "3 year", labels = scales::label_date_short())+
theme_bw(base_size = 12)
ts.df %>%
ggplot(aes(x = ds, y = y))+
geom_line()+
geom_smooth(fill = "blue", color = "red", alpha = .2)+
scale_y_continuous(name = expression(Temperature~(degree*C)))+
scale_x_date(date_breaks = "3 year", labels = scales::label_date_short())+
theme_bw(base_size = 12)
ts.df %>%
ggplot(aes(x = ds, y = y))+
geom_line()+
geom_smooth(fill = "blue", color = "blue", alpha = .2)+
scale_y_continuous(name = expression(Temperature~(degree*C)))+
scale_x_date(date_breaks = "3 year", labels = scales::label_date_short())+
theme_bw(base_size = 12)
ts.df %>%
ggplot(aes(x = ds, y = y))+
geom_line()+
geom_smooth(fill = "red", color = "red", alpha = .2)+
scale_y_continuous(name = expression(Temperature~(degree*C)))+
scale_x_date(date_breaks = "3 year", labels = scales::label_date_short())+
theme_bw(base_size = 12)
ts.df %>%
ggplot(aes(x = ds, y = y))+
geom_line()+
geom_smooth(fill = "red", color = "red", alpha = .2)+
scale_y_continuous(name = expression(Temperature~(degree*C)))+
scale_x_date(date_breaks = "3 year", labels = scales::label_date_short())+
theme_bw(base_size = 12)+
theme(axis.title.x = element_blank())
ts.df = ts.temp %>%
window(start = c(2000,1)) %>%
TSstudio::ts_to_prophet()
ts.df %>%
ggplot(aes(x = ds, y = y))+
geom_line()+
geom_smooth(fill = "red", color = "red", alpha = .2)+
scale_y_continuous(name = expression(Temperature~(degree*C)))+
scale_x_date(date_breaks = "3 year", labels = scales::label_date_short())+
theme_bw(base_size = 12)+
theme(axis.title.x = element_blank())
ts.df = ts.temp %>%
window(start = c(1980,1)) %>%
TSstudio::ts_to_prophet()
ts.df %>%
ggplot(aes(x = ds, y = y))+
geom_line()+
geom_smooth(fill = "red", color = "red", alpha = .2)+
scale_y_continuous(name = expression(Temperature~(degree*C)))+
scale_x_date(date_breaks = "3 year", labels = scales::label_date_short())+
theme_bw(base_size = 12)+
theme(axis.title.x = element_blank())
ts.df = ts.temp %>%
window(start = c(1950,1)) %>%
TSstudio::ts_to_prophet()
ts.df %>%
ggplot(aes(x = ds, y = y))+
geom_line()+
geom_smooth(fill = "red", color = "red", alpha = .2)+
scale_y_continuous(name = expression(Temperature~(degree*C)))+
scale_x_date(date_breaks = "3 year", labels = scales::label_date_short())+
theme_bw(base_size = 12)+
theme(axis.title.x = element_blank())
ts.df = ts.temp %>%
window(start = c(1970,1)) %>%
TSstudio::ts_to_prophet()
ts.df %>%
ggplot(aes(x = ds, y = y))+
geom_line()+
geom_smooth(fill = "red", color = "red", alpha = .2)+
scale_y_continuous(name = expression(Temperature~(degree*C)))+
scale_x_date(date_breaks = "3 year", labels = scales::label_date_short())+
theme_bw(base_size = 12)+
theme(axis.title.x = element_blank())
ts.df = ts.temp %>%
window(start = c(1980,1)) %>%
TSstudio::ts_to_prophet()
ts.df %>%
ggplot(aes(x = ds, y = y))+
geom_line()+
geom_smooth(fill = "red", color = "red", alpha = .2)+
scale_y_continuous(name = expression(Temperature~(degree*C)))+
scale_x_date(date_breaks = "3 year", labels = scales::label_date_short())+
theme_bw(base_size = 12)+
theme(axis.title.x = element_blank())
ts.df %>%
ggplot(aes(x = ds, y = y))+
geom_line()+
geom_smooth(fill = "red", color = "red", alpha = .2)+
scale_y_continuous(name = expression(Temperature~(degree*C)))+
scale_x_date(date_breaks = "3 year", labels = scales::label_date_short())+
theme_bw(base_size = 12)+
theme(axis.title.x = element_blank(), panel.grid.minor = element_blank())
which.max(ts.df$y)
which.max(ts.df)
which.max(ts.df$y)
ts.df %>% slice(which.max(ts.df$y))
ts.df %>% slice(which.min(ts.df$y))
ts.df %>% slice(which.max(ts.df$y))
ts.df %>% prophet()
m = ts.df %>% prophet()
m
m %>% plot()
m
future = m %>%
make_future_dataframe(120,freq = "month")
future
forecast = m %>% predict(future)
forecast
plot(m, forecast)
plot(m, forecast)+
scale_y_continuous(name = expression(Temperature~(degree*C)))+
scale_x_date(date_breaks = "3 year", labels = scales::label_date_short())+
theme_bw(base_size = 12)+
theme(axis.title.x = element_blank(), panel.grid.minor = element_blank())
plot(m, forecast)+
scale_y_continuous(name = expression(Temperature~(degree*C)))+
# scale_x_date(date_breaks = "3 year", labels = scales::label_date_short())+
theme_bw(base_size = 12)+
theme(axis.title.x = element_blank(), panel.grid.minor = element_blank())
plot(m, forecast)+
scale_y_continuous(name = expression(Temperature~(degree*C)))+
# scale_x_date(date_breaks = "3 year", labels = scales::label_date_short())+
scale_x_continuous(labels = scales::breaks_width(width = 2))
plot(m, forecast)+
scale_y_continuous(name = expression(Temperature~(degree*C)))+
# scale_x_date(date_breaks = "3 year", labels = scales::label_date_short())+
scale_x_continuous(labels = scales::breaks_width(width = 2))+
theme_bw(base_size = 12)+
theme(axis.title.x = element_blank(), panel.grid.minor = element_blank())
plot(m, forecast)+
scale_y_continuous(name = expression(Temperature~(degree*C)))+
# scale_x_date(date_breaks = "3 year", labels = scales::label_date_short())+
theme_bw(base_size = 12)+
theme(axis.title.x = element_blank(), panel.grid.minor = element_blank())
plot(x = m, fcst = forecast, )+
scale_y_continuous(name = expression(Temperature~(degree*C)))+
# scale_x_date(date_breaks = "3 year", labels = scales::label_date_short())+
theme_bw(base_size = 12)+
theme(axis.title.x = element_blank(), panel.grid.minor = element_blank())
plot(x = m, fcst = forecast, uncertainty = T)+
scale_y_continuous(name = expression(Temperature~(degree*C)))+
# scale_x_date(date_breaks = "3 year", labels = scales::label_date_short())+
theme_bw(base_size = 12)+
theme(axis.title.x = element_blank(), panel.grid.minor = element_blank())
plot(x = m, fcst = forecast, uncertainty = T,plot_cap = T)+
scale_y_continuous(name = expression(Temperature~(degree*C)))+
# scale_x_date(date_breaks = "3 year", labels = scales::label_date_short())+
theme_bw(base_size = 12)+
theme(axis.title.x = element_blank(), panel.grid.minor = element_blank())
plot(x = m, fcst = forecast, uncertainty = T,plot_cap = T,)+
scale_y_continuous(name = expression(Temperature~(degree*C)))+
# scale_x_date(date_breaks = "3 year", labels = scales::label_date_short())+
theme_bw(base_size = 12)+
theme(axis.title.x = element_blank())
plot(x = m, fcst = forecast, uncertainty = T,plot_cap = T,)+
scale_y_continuous(name = expression(Temperature~(degree*C)))+
# scale_x_date(date_breaks = "3 year", labels = scales::label_date_short())+
theme_bw(base_size = 12)+
theme(axis.title.x = element_blank())
plot(x = m, fcst = forecast, uncertainty = T,plot_cap = T,)+
scale_y_continuous(name = expression(Temperature~(degree*C)))+
# scale_x_date(date_breaks = "3 year", labels = scales::label_date_short())+
theme_bw(base_size = 12)+
theme(axis.title.x = element_blank())
plot(x = m, fcst = forecast, uncertainty = T,plot_cap = T,)+
scale_y_continuous(name = expression(Temperature~(degree*C)))+
# scale_x_date(date_breaks = "3 year", labels = scales::label_date_short())+
theme_bw(base_size = 12)+
theme(axis.title.x = element_blank())
plot(x = m, fcst = forecast, uncertainty = T,plot_cap = T,)
plot(x = m, fcst = forecast, uncertainty = T,plot_cap = T)
plot_forecast_component(x = m, fcst = forecast, uncertainty = T,plot_cap = T)
plot_forecast_component(m = m, fcst = forecast, uncertainty = T,plot_cap = T)
forecast
plot_forecast_component(m = m, fcst = forecast, name = "trend")
fcst
forecast
plot_forecast_component(m = m, fcst = forecast, name = "additive_terms")
plot_forecast_component(m = m, fcst = forecast, name = "trend")
plot(x = m, fcst = forecast, uncertainty = T,plot_cap = T,)+
scale_y_continuous(name = expression(Temperature~(degree*C)))+
# scale_x_date(date_breaks = "3 year", labels = scales::label_date_short())+
theme_bw(base_size = 12)+
theme(axis.title.x = element_blank())+
add_changepoints_to_plot()
plot(x = m, fcst = forecast, uncertainty = T,plot_cap = T,)+
scale_y_continuous(name = expression(Temperature~(degree*C)))+
# scale_x_date(date_breaks = "3 year", labels = scales::label_date_short())+
theme_bw(base_size = 12)+
theme(axis.title.x = element_blank())+
add_changepoints_to_plot(m = m)
plot(x = m, fcst = forecast, uncertainty = T,plot_cap = T,)+
scale_y_continuous(name = expression(Temperature~(degree*C)))+
# scale_x_date(date_breaks = "3 year", labels = scales::label_date_short())+
theme_bw(base_size = 12)+
theme(axis.title.x = element_blank())+
add_changepoints_to_plot(m = m, threshold = 0.05)
plot(x = m, fcst = forecast, uncertainty = T,plot_cap = T,)+
scale_y_continuous(name = expression(Temperature~(degree*C)))+
# scale_x_date(date_breaks = "3 year", labels = scales::label_date_short())+
theme_bw(base_size = 12)+
theme(axis.title.x = element_blank())+
add_changepoints_to_plot(m = m, threshold = 0.1)
plot(x = m, fcst = forecast, uncertainty = T,plot_cap = T,)+
scale_y_continuous(name = expression(Temperature~(degree*C)))+
# scale_x_date(date_breaks = "3 year", labels = scales::label_date_short())+
theme_bw(base_size = 12)+
theme(axis.title.x = element_blank())+
add_changepoints_to_plot(m = m, threshold = 0.1)
monthly %>% FSA::headtail()
monthly %>% FSA::headtail(n = 5)
plot(x = m, fcst = forecast, uncertainty = T)
dyplot.prophet(x = m, fcst = forecast, uncertainty = T)
ts.df %>%
ggplot(aes(x = ds, y = y))+
geom_line()+
geom_smooth(fill = "red", color = "red", alpha = .2)+
scale_y_continuous(name = expression(Temperature~(degree*C)))+
scale_x_date(date_breaks = "3 year", labels = scales::label_date_short())+
theme_bw(base_size = 12)+
theme(axis.title.x = element_blank(), panel.grid.minor = element_blank())
plot_forecast_component(x = m, fcst = forecast, uncertainty = T)
plot_forecast_component(m = m, fcst = forecast, uncertainty = T)
plot_forecast_component(m = m, fcst = forecast)
plot_forecast_component(m = m, fcst = forecast)
blogdown::serve_site()
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, comment = "")
plot_forecast_component(m = m, fcst = forecast, name = "trend")
blogdown::serve_site()
blogdown::stop_server()
blogdown::serve_site()
